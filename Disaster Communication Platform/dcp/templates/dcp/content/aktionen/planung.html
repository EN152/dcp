{% extends "dcp/design/base.html" %}

{% block title %} Aktion planen {% endblock %}

{% block content %}
{% load bootstrap3 %}
{% load mathfilters %}
{% load get_at_index %}

<div class="row">
	<div class="col-lg-12">

		{% if error %}
		<div class="alert alert-success alert-dismissable">
			<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
			<p>{{ error }}</p>
			<p>
				<form action="/aktionen/planung" type="form-inline">
					<input class="btn btn-primary" type="submit" value="Events ansehen">
				</form>
			</p>
		</div>
		
		{% endif %}

		{% for event in events %}
		<div class="panel panel-green">
			<div class="panel-heading"><h3>{{ event.0.title }}</h3></div>
			<div class="panel-body">
				<p>{{ event.0.description }}</p>

				<div class="dataTable_wrapper">
					<table width="100%" class="table table-striped table-bordered table-hover">
						<thead>
							<th width="33%"><center><i class="fa fa-user" style="font-size: 3em;" aria-hidden="true"></i></center></th>
							
							<th width="33%"><center><i class="fa fa-car" style="font-size: 3em;" aria-hidden="true"></i></center></th>
							
							<th width="33%"><center><i class="fa fa-star" style="font-size: 3em;" aria-hidden="true"></i></center></th>
						</thead>
						<tbody>

							{% for i in event.1 %}
							<tr>
								{% if i <= event.0.numberOfUsers %}
								{% if i < event.2 %}
								<td style="text-align: center;">
									<center>
										<div class="alert {% if event.3|get_at_index:forloop.counter0 == event.5 %}alert-info{% else %}alert-success{% endif %}" style="align: center; margin: 0px;">
											<p><b><i class="fa fa-user"></i><br>{{ event.3|get_at_index:forloop.counter0 }}</b></p>

											{% if event.3|get_at_index:forloop.counter0 == event.5 %}
											<p>
												<form role="form" id="user" method="post">{% csrf_token %}
													<input type="hidden" name="user_id" value="{{ i }}"/>
													<input type="hidden" name="event_id" value="{{ event.0.id }}"/>
													<button id="{{ i }}" type="submit" class="btn btn-danger" name="post_identifier" value="remove_user"><i class="fa fa-times" aria-hidden="true"></i> Absagen</i></button>
												</form>
											</p>
											{% endif %}



										</div>
									</center>
									
									{% else %}


									
									{% if event.4 %}
									<td style="text-align: center;"> (noch offen)
										{% else %}
										
										<td style="text-align: center;">
											<form role="form" id="user" method="post">{% csrf_token %}
												<input type="hidden" name="user_id" value="{{ i }}"/>
												<input type="hidden" name="event_id" value="{{ event.0.id }}"/>
												<button id="{{ i }}" type="submit" class="btn btn-info" name="post_identifier" value="add_user"><i class="fa fa-check"></i> Helfen <i class="fa fa-user"></i></button>
											</form>
											{% endif %}
											
											{% endif %}
											

										</td>{% else %}<td style="visibility: hidden;"></td>{% endif%}



										{% if i <= event.0.numberOfCars %}<td style="text-align: center;">

										Car {{i}}

									</td>{% else %}<td style="visibility: hidden;"></td>{% endif%}
									{% if i <= event.0.numberOfSpecials %}<td style="text-align: center;">

									Star {{i}}

								</td>{% else %}<td style="visibility: hidden;"></td>{% endif%}
							</tr>
							{% endfor %}		
							
							
							
							




							
							

						</tbody>
					</table>
				</div>
			</div>
		</div>
		{% endfor %}	
	</div>
</div>

{% endblock content %}